print(a)
meanA <- mean(a)
meanA <- mean(a)
print(meanA)
print(mean(a))
sometihweohreworoewjrklewjrlkjewklrjewklrjewlkrjewkljrewlkjrewkjrljewlrkjewklrjkew <- c(1,2,3,4,5,6,6)
ewrjlhewlrhwelrjklwejrklewjrlkewjrklwejrkewjlrkjew <- c(1,22,3,4,5,36,6)
print(sometihweohreworoewjrklewjrlkjewklrjewklrjewlkrjewkljrewlkjrewkjrljewlrkjewklrjkew - ewrjlhewlrhwelrjklwejrklewjrlkewjrklwejrkewjlrkjew
)
p <- sometihweohreworoewjrklewjrlkjewklrjewklrjewlkrjewkljrewlkjrewkjrljewlrkjewklrjkew - ewrjlhewlrhwelrjklwejrklewjrlkewjrklwejrkewjlrkjew
print(p)
pminus <- sometihweohreworoewjrklewjrlkjewklrjewklrjewlkrjewkljrewlkjrewkjrljewlrkjewklrjkew - ewrjlhewlrhwelrjklwejrklewjrlkewjrklwejrkewjlrkjew
print(p)
print(pminus)
source("https://bioconductor.org/biocLite.R")
biocLite("TCGAbiolinksGUI", dependencies = TRUE)
biocLite("TCGAbiolinksGUI", dependencies = TRUE)
?spearman
?spearman.test
??spearman.tes
??spearman.test
?cor.test
pnorm(0.05)
pnorm(1.96)
2*pnorm(1.96)
pnorm(2.96)
pnorm(0.8)
pnorm(1.2)
pnorm(1.5)
pnorm(1.6)
pnorm(1.7)
pnorm(1.68)
pnorm(1.67)
pnorm(1.66)
pnorm(1.65)
pnorm(1.64)
pnorm(1.649)
pnorm(1.648)
pnorm(1.646)
pnorm(1.645)
pnorm(1.6459)
pnorm(1.6455)
pnorm(1.6452)
pnorm(1.6450)
pnorm(1.64501)
pnorm(1.64500)
pnorm(1.645001)
pnorm(1.64500001)
pnorm(1.645000)
?kruskal.test
library(dunnTest)
install.packages("dunn.test")
library(dunn.test)
?dunn.test
pnorm(-1.50392)
a <- pnorm(-1.50392)
a/2
a
a/2
install.packages("motmot.2.0", repos="https://www.stats.bris.ac.uk/R/")
library(motmot.2.0)
data(anolis.tree)
head(anolis)
data(anolis.tree)
data(anolis.data)
attach(anolis.data)
anolis.tree
anolis.data
names(anolis.data)
Species
Island_type
anolis.tree
y.data <- matrix(anolis.data[,"Male_SVL"])
y.data
rownames(y.data) <- rownames(anolis.data)
sortedData <- sortTraitData(phy = anolis.tree, y=y.data)
head(sortedData)
phy <- sortedData$phy
head(phy)
male.length <- sortedData$trait
male.length
# plot tree
plot.phylo(phy, show.tip.label = TRUE, no.margin = TRUE, edge.col = "grey20", cex = 0.25, label.offset = 1)
# argumets for plot.phylo
args(plot.phylo)
# plot fan tree
plot.phylo(phy, show.tip.label = TRUE, no.margin = TRUE, edge.col = "grey20", cex = 0.25, label.offset = 1, type="fan")
plot.phylo(phy, show.tip.label=TRUE, no.margin=TRUE, edge.col=heat.colors(length(phy$edge[,1])), cex=0.25, label.offset=1, type="fan", tip.col=rainbow(Ntip(phy)))
plot(phy, show.tip.label=FALSE, no.margin=TRUE, edge.col="grey20")
nodelabels(182, 182, bg = "black", col = "white")
phy.clade <- extract.clade(phy, 182)
male.length.clade <- as.matrix(male.length[match(phy.clade$tip.label, rownames(male.length)),])
male.length.clade
phy.clade$edge
plot.phylo(phy.clade, show.tip.label=FALSE, no.margin=FALSE, edge.col="grey20", cex=0.25, label.
offset=1)
plot.phylo(phy.clade, show.tip.label=FALSE, no.margin=FALSE, edge.col="grey20", cex=0.25, label.offset=1)
tiplabels(frame='none', offset=1, cex=0.6)
nodelabels(text=unique(phy.clade$edge[,1]), frame='c', cex=0.5, bg="white")
plot.phylo(phy.clade, show.tip.label=FALSE, no.margin=FALSE, edge.col="grey20", cex=0.25, label.offset=1)
edgelabels(round(phy.clade$edge.length, 2), cex=0.35, frame='c', bg="white")
set.seed(20)
random.phy <- rtree(30)
random.phy.2 <- random.phy
random.phy
random.phy.2
set.seed(20)
random.phy <- rtree(30)
random.phy.2 <- random.phy
random.phy.2$edge.length <- NULL
random.phy.2
# give it some random lengths
random.phy.2$edge.length <- NULL
random.phy.2
random.phy.2$edge.length <- rep(1, Ntip(random.phy) * 2 - 2)
par(mfrow=c(1,2))
plot(random.phy, cex=0.6)
mtext("original tree", 3, at=4)
plot(random.phy.2, cex=0.6)
mtext("unit branch lengths", 3, at=4)
data(anolis.tree)
set.seed(82)
anolis.tree$node.label <- NULL
lm.data <- transformPhylo.sim(phy = anolis.tree, n = 2, model = "bm")
data <- data.frame(x = lm.data[,1], y = lm.data[, 2], names = anolis.tree$tip, row.names = anolis.tree$tip)
dat <- data.frame(x = lm.data[,1], y = lm.data[, 2], names = anolis.tree$tip, row.names = anolis.tree$tip)
linear.model <- lm(y ~ x, data = dat)
summary(linear.model)
comp.dat <- comparative.data(anolis.tree, dat, names)
pgls.model <- pgls( y ~ x, data = comp.dat, lambda="ML")
summary(pgls.model)
plot(y ~ x, data = dat, pch=19, col="grey", xaxs="i", yaxs="i", xlim=c(-25, 25), ylim=c(-25, 25), las=1)
abline(linear.model, lwd=2, col="grey20")
abline(pgls.model, lwd=2, lty=2, col="grey60")
legend("topleft", legend=c("OLS model", "PGLS model"), lwd=2, lty=c(1,2), col=c("grey40", "grey80"))
plot(y ~ x, data = dat, pch=19, col="grey", xaxs="i", yaxs="i", xlim=c(-25, 25), ylim=c(-25, 25), las=1)
abline(linear.model, lwd=2, col="grey20")
abline(pgls.model, lwd=2, lty=2, col="grey60")
legend("topleft", legend=c("OLS model", "PGLS model"), lwd=2, lty=c(1,2), col=c("grey40", "grey80"))
binom.test(9, 13)
binom.test(9, 13, alternative = "g")
binom.test(6, 13, alternative = "g")
binom.test(6, 13)
binom.test(6, 12)
binom.test(6, 12, alternative = "g")
binom.test(3, 12, alternative = "g")
binom.test(3, 12, alternative = "l")
b <- function(x, y, a = NULL) {
return (binom.test(a, b, alternative = a))
}
b(3, 12)
b <- function(x, y, a = NULL) {
if(a) {
return (binom.test(a, b, alternative = a))
} else {
return (binom.test(a, b))
}
}
b <- function(x, y, a = NULL) {
if(a) {
return (binom.test(a, b, alternative = a))
} else {
return (binom.test(a, b))
}
}
b(3, 12)
b <- function(x, y, a = NULL) {
if(!is.null(a)) {
return (binom.test(a, b, alternative = a))
} else {
return (binom.test(a, b))
}
}
b(3, 12)
b <- function(x, y, a = NULL) {
if(!is.null(a)) {
return (binom.test(x,y, alternative = a))
} else {
return (binom.test(x,y))
}
}
b(3, 12)
b(9, 13)
b(4, 12)
b(4, 12, alternative = "l")
b(4, 12, a = "l")
b(43, 12, a = "l")
b(3, 12, a = "l")
a <- c(63,56,38,31,38,24,18,27,22,23,12,12,13,20,11,7,10)
a / 630
a <- c(55,63,56,38,31,38,24,18,27,22,23,12,12,13,20,11,7,10)
a / 630
b <- function(x, y, a = NULL) {
if(!is.null(a)) {
return (binom.test(x,y, alternative = a))
} else {
return (binom.test(x,y))
}
}
b(9, 13)
b(9, 13, alternative = "g")
b(9, 13, a = "g")
b(6, 13, a = "g")
b(6, 13)
b(6, 13, a = "l")
b(3,12)
b(3,12, a = "l")
b(4,12, a = "l")
b(3,12, a = "l")
b(3,13, a = "l")
b(3,13, a = "g")
b(3,13)
b(0, 12)
b(0, 12, alternative = "g")
b(0, 12, a = "l")
b(1, 12, a = "l")
b(8, 13, a = "l")
b(8, 13, a = "g")
b(8, 12, a = "g")
b(8, 13, a = "g")
b(3, 13, a = "g")
b(4, 12, a = "g")
b(6, 12, a = "g")
b(6, 12,)
b(6, 12, a = "l")
b(6, 12, a = "g")
b(6, 12, a = "l")
b(6, 12, a = "g")
b(4, 12, a = "g")
b(4, 12, a = "l")
b(8, 13, a = "g")
b(7, 13, a = "g")
b(7, 10, a = "g")
b(7, 10)
metap
install.packages("metap")
library(metap)
?metap
sumlog(0.1334, 0.6278, 0.0730, 0.1939)
sumlog(c(0.1334, 0.6278, 0.0730, 0.1939))
b(6, 10, a = "g")
b(6, 12, a = "g")
b(3, 12, a = "g")
b(4, 12, a = "g")
sumlog(c(0.1334, 0.6128, 0.9807, 0.927))
b(8, 9, a = "g")
b(1, 12, a = "g")
b(1, 12, a = "l")
b <- function(x, y, a = NULL) {
if(!is.null(a)) {
return (binom.test(x,y, alternative = a))
} else {
return (binom.test(x,y))
}
}
binom.test(9, 1935, p = 0.05)
binom.test(9, 1935, p = 0.05, alternative = "g")
binom.test(9, 1935, p = 0.05, alternative = "l")
binom.test(9, 1935, p = 0.05, alternative = "g")
binom.test(180, 456, p = 0.05)
setwd("Documents/scripts/ess_stops/")
library(ggplot2)
# just stop codon density either side of the splice site
file = read.csv("results/temp/stop_codon_position_densities.csv", head = T)
plot(file$position, file$density)
plot(file$position, file$density, xlab = "Position relative to splice site", ylab = "Stop codon density")
pdf("results/plots/all_stop_density.pdf")
plot(file$position, file$density, xlab = "Position relative to splice site", ylab = "Stop codon density")
dev.off()
abline(v = 0)
plot(file$position, file$density, xlab = "Position relative to splice site", ylab = "Stop codon density")
abline(v = 0, lty = 2)
pdf("results/plots/all_stop_density.pdf")
plot(file$position, file$density, xlab = "Position relative to splice site", ylab = "Stop codon density")
abline(v = 0, lty = 2)
dev.off()
# stop density in each frame each side of the splice site
file = read.csv("results/temp/stop_codon_position_frame_densities.csv", head = T)
file$frame = as.factor(file$frame)
ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line()
ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(x = 0, lty = 2)
ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
ggsave(plot = plot, path = "results/plots/stop_density_per_frame.pdf")
ggsave(plot = plot, filename = "results/plots/stop_density_per_frame.pdf")
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
ggsave(plot = plot, filename = "results/plots/stop_density_per_frame.pdf")
ggsave(plot = plot, filename = "results/plots/stop_density_per_frame.pdf", width= 7, height = 5)
ggsave(plot = plot, filename = "results/plots/stop_density_per_frame.pdf", width= 10, height = 5)
cairo_pdf(file$position, file$density, xlab = "Position relative to splice site", ylab = "Stop codon density")
cairo_pdf("results/plots/all_stop_density.pdf")
plot(file$position, file$density, xlab = "Position relative to splice site", ylab = "Stop codon density")
abline(v = 0, lty = 2)
dev.off()
cairo_pdf("results/plots/all_stop_density.pdf")
plot(file$position, file$density, xlab = "Position relative to splice site", ylab = "Stop codon density")
abline(v = 0, lty = 2)
dev.off()
cairo_pdf("results/plots/all_stop_density.pdf")
plot(file$position, file$density, xlab = "Position relative to splice site", ylab = "Stop codon density", cex = 0.4)
abline(v = 0, lty = 2)
dev.off()
dev.off()
dev.off()
# just stop codon density either side of the splice site
file = read.csv("results/temp/stop_codon_position_densities.csv", head = T)
cairo_pdf("results/plots/all_stop_density.pdf")
plot(file$position, file$density, xlab = "Position relative to splice site", ylab = "Stop codon density", cex = 0.4)
abline(v = 0, lty = 2)
dev.off()
cairo_pdf("results/plots/all_stop_density.pdf")
plot(file$position, file$density, xlab = "Position relative to splice site", ylab = "Stop codon density")
abline(v = 0, lty = 2)
dev.off()
# stop density in each frame each side of the splice site
file = read.csv("results/temp/stop_codon_position_frame_densities.csv", head = T)
dev.off()
# stop density in each frame each side of the splice site
file = read.csv("results/temp/stop_codon_position_frame_densities.csv", head = T)
# just stop codon density either side of the splice site
file = read.csv("results/temp/stop_codon_position_densities.csv", head = T)
cairo_pdf("results/plots/all_stop_density.pdf")
plot(file$position, file$density, xlab = "Position relative to splice site", ylab = "Stop codon density")
abline(v = 0, lty = 2)
dev.off()
# stop density in each frame each side of the splice site for 3n introns
file = read.csv("results/temp/stop_codon_position_frame_3n_densities.csv", head = T)
file$frame = as.factor(file$frame)
ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line()
# stop density in each frame each side of the splice site for 3n introns
file = read.csv("results/temp/stop_codon_position_frame_3n_densities.csv", head = T)
file$frame = as.factor(file$frame)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
ggsave(plot = plot, filename = "results/plots/stop_density_per_frame_3n_introns.pdf", width= 10, height = 5)
# stop density in each frame each side of the splice site for 3n introns
file = read.csv("results/temp/stop_codon_position_frame_densities_first_hit.csv", head = T)
file$frame = as.factor(file$frame)
ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_col(position = "dodge")
# stop density in each frame at the first stop codon hit
file = read.csv("results/temp/stop_codon_position_frame_densities_first_hit.csv", head = T)
file$frame = as.factor(file$frame)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_col(position = "dodge") +
geom_vline(xintercept = 0, lty = 2)
ggsave(plot = plot, filename = "results/plots/stop_density_per_frame_3n_introns.pdf", width= 10, height = 5)
# stop density in each frame each side of the splice site for 3n introns
file = read.csv("results/temp/stop_codon_position_frame_3n_densities.csv", head = T)
file$frame = as.factor(file$frame)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
ggsave(plot = plot, filename = "results/plots/stop_density_per_frame_3n_introns.pdf", width= 10, height = 5)
# stop density in each frame at the first stop codon hit
file = read.csv("results/temp/stop_codon_position_frame_densities_first_hit.csv", head = T)
# stop density in each frame at the first stop codon hit
file = read.csv("results/temp/stop_codon_position_frame_densities_first_hit.csv", head = T)
file$frame = as.factor(file$frame)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_col(position = "dodge") +
geom_vline(xintercept = 0, lty = 2)
ggsave(plot = plot, filename = "results/plots/stop_density_per_frame_3n_introns_first_hit.pdf", width= 10, height = 5)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
ggsave(plot = plot, filename = "results/plots/stop_density_per_frame_3n_introns_first_hit.pdf", width= 10, height = 5)
# cassete exon decoys
file = read.csv("results/temp/cassette_decoys_frame_densities", head = T)
# cassete exon decoys
file = read.csv("results/temp/cassette_decoys_frame_densities.csv", head = T)
file$frame = as.factor(file$frame)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
plot
# cassete exon decoys
file = read.csv("results/temp/cassette_decoys_frame_densities.csv", head = T)
file$frame = as.factor(file$frame)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
plot
# cassete exon decoys
file = read.csv("results/temp/cassette_decoys_frame_densities.csv", head = T)
file$frame = as.factor(file$frame)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
plot
# cassete exon decoys
file = read.csv("results/temp/cassette_decoys_frame_densities.csv", head = T)
file$frame = as.factor(file$frame)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
plot
# cassete exon decoys
file = read.csv("results/temp/cassette_decoys_frame_densities.csv", head = T)
file$frame = as.factor(file$frame)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
plot
ggsave(plot = plot, filename = "results/plots/casstte_decoys.pdf", width= 10, height = 5)
# cassete exon decoys 3n
file = read.csv("results/temp/cassette_decoys_3n_frame_densities.csv", head = T)
file$frame = as.factor(file$frame)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
plot
# cassete exon decoys
file = read.csv("results/temp/cassette_decoys_frame_densities.csv", head = T)
file$frame = as.factor(file$frame)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
plot
ggsave(plot = plot, filename = "results/plots/casstte_decoys.pdf", width= 10, height = 5)
# cassete exon decoys 3n
file = read.csv("results/temp/cassette_decoys_3n_frame_densities.csv", head = T)
file$frame = as.factor(file$frame)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
plot
ggsave(plot = plot, filename = "results/plots/casstte_decoys_3n.pdf", width= 10, height = 5)
# cassete exons
file = read.csv("results/temp/cassette_frame_densities.csv", head = T)
file$frame = as.factor(file$frame)
# cassete exons
file = read.csv("results/temp/cassette_frame_densities.csv", head = T)
file$frame = as.factor(file$frame)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
plot
ggsave(plot = plot, filename = "results/plots/casstte_decoys.pdf", width= 10, height = 5)
ggsave(plot = plot, filename = "results/plots/casstte.pdf", width= 10, height = 5)
# cassete exon decoys
file = read.csv("results/temp/cassette_decoys_frame_densities.csv", head = T)
file$frame = as.factor(file$frame)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
plot
ggsave(plot = plot, filename = "results/plots/casstte_decoys.pdf", width= 10, height = 5)
# cassete exon decoys 3n
file = read.csv("results/temp/cassette_decoys_3n_frame_densities.csv", head = T)
file$frame = as.factor(file$frame)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
plot
ggsave(plot = plot, filename = "results/plots/casstte_decoys_3n.pdf", width= 10, height = 5)
# constitutive exons
file = read.csv("results/temp/cassette_frame_densities.csv", head = T)
file$frame = as.factor(file$frame)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
plot
ggsave(plot = plot, filename = "results/plots/constitutive.pdf", width= 10, height = 5)
# constitutive exons 3n
file = read.csv("results/temp/cassette_3n_frame_densities.csv", head = T)
# constitutive exons
file = read.csv("results/temp/constitutive_frame_densities.csv", head = T)
# constitutive exons 3n
file = read.csv("results/temp/cassette_3n_frame_densities.csv", head = T)
# constitutive exons 3n
file = read.csv("results/temp/constitutive_3n_frame_densities.csv", head = T)
file$frame = as.factor(file$frame)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
plot
ggsave(plot = plot, filename = "results/plots/constitutive_3n.pdf", width= 10, height = 5)
# constitutive exons
file = read.csv("results/temp/constitutive_frame_densities.csv", head = T)
# constitutive exons
file = read.csv("results/temp/constitutive_frame_densities.csv", head = T)
file$frame = as.factor(file$frame)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
plot
ggsave(plot = plot, filename = "results/plots/constitutive.pdf", width= 10, height = 5)
# constitutive decoys
file = read.csv("results/temp/constitutive_decoy_frame_densities.csv", head = T)
file$frame = as.factor(file$frame)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
plot
ggsave(plot = plot, filename = "results/plots/constitutive_decoy.pdf", width= 10, height = 5)
# constitutive decoys 3n
file = read.csv("results/temp/constitutive_decoy_3n_frame_densities.csv", head = T)
file$frame = as.factor(file$frame)
plot = ggplot(data = file, aes(x = file$position, y = file$density, col = file$frame)) +
geom_line() +
geom_vline(xintercept = 0, lty = 2)
plot
ggsave(plot = plot, filename = "results/plots/constitutive_decoy_3n.pdf", width= 10, height = 5)
